{"data":{"github":{"repository":{"issue":{"number":6,"title":"Disable dynamic import code splitting","bodyHTML":"<p>Code splitting for dynamic import is great. However, incremental build spend much more time if there are too many chunks to split. So it would be perfect if we use eager mode for development and lazy mode for production.</p>\n<p>Bad news: right now, you can only set webpackMode per import expression like this:</p>\n<div class=\"highlight highlight-source-js\"><pre><span class=\"pl-k\">import</span>(\n  <span class=\"pl-c\"><span class=\"pl-c\">/*</span> webpackMode: \"lazy\" <span class=\"pl-c\">*/</span></span>\n  <span class=\"pl-s\"><span class=\"pl-pds\">'</span>module<span class=\"pl-pds\">'</span></span>\n);</pre></div>\n<p>First try:</p>\n<div class=\"highlight highlight-source-js\"><pre><span class=\"pl-k\">if</span> (<span class=\"pl-c1\">process</span>.<span class=\"pl-smi\">env</span>.<span class=\"pl-c1\">NODE_ENV</span> <span class=\"pl-k\">===</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>production<span class=\"pl-pds\">'</span></span>) {\n  <span class=\"pl-k\">import</span>(\n    <span class=\"pl-c\"><span class=\"pl-c\">/*</span> webpackMode: \"lazy\" <span class=\"pl-c\">*/</span></span>\n    <span class=\"pl-s\"><span class=\"pl-pds\">'</span>module<span class=\"pl-pds\">'</span></span>\n  );\n} <span class=\"pl-k\">else</span> {\n  <span class=\"pl-k\">import</span>(\n    <span class=\"pl-c\"><span class=\"pl-c\">/*</span> webpackMode: \"eager\" <span class=\"pl-c\">*/</span></span>\n    <span class=\"pl-s\"><span class=\"pl-pds\">'</span>module<span class=\"pl-pds\">'</span></span>\n  );\n}</pre></div>\n<p>Turn out, this just getting worse. Clearly the bundler doesn't respect <code>process.env.NODE_ENV</code> here.</p>\n<p>Workaround:<br>\nUsing NormalModuleReplacementPlugin to load different file in different env.</p>\n<div class=\"highlight highlight-source-js\"><pre><span class=\"pl-k\">new</span> <span class=\"pl-en\">webpack.NormalModuleReplacementPlugin</span>(<span class=\"pl-sr\"><span class=\"pl-pds\">/</span><span class=\"pl-cce\">\\.\\/</span>lazy-load-import<span class=\"pl-k\">$</span><span class=\"pl-pds\">/</span></span>, <span class=\"pl-k\">function</span>(<span class=\"pl-smi\">resource</span>) {\n  <span class=\"pl-smi\">resource</span>.<span class=\"pl-smi\">request</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">resource</span>.<span class=\"pl-smi\">request</span>.<span class=\"pl-c1\">replace</span>(<span class=\"pl-sr\"><span class=\"pl-pds\">/</span>lazy<span class=\"pl-pds\">/</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>eager<span class=\"pl-pds\">'</span></span>);\n})</pre></div>\n<p>Then put different logic in lazy-load-import.js and eager-load-import.js</p>","createdAt":"2018-12-11T12:15:02Z","labels":{"edges":[{"node":{"name":"post"}},{"node":{"name":"webpack"}}]}}}}},"pageContext":{"slug":6}}