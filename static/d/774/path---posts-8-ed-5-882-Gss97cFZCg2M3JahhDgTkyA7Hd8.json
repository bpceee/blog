{"data":{"github":{"repository":{"issue":{"number":8,"title":"A bizarre pitfall when converting CommonJS to ES6 module","bodyHTML":"<p>Well, it wouldn't be bizarre if you really know inside out of Webpack and ES6 module..</p>\n<p>As we all know, <a class=\"user-mention\" data-hovercard-type=\"organization\" data-hovercard-url=\"/orgs/font-face/hovercard\" href=\"https://github.com/font-face\">@font-face</a> defined in css will trigger a http request for the font file based on the <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/filter-function/url\" rel=\"nofollow\">url() CSS function</a>. However, after updated to ES6 module, the url somehow doesn't value the <code>__webpack_public_path__</code> set in the entry point <code>app.ts</code>. Thus, many failed font requests.</p>\n<p>Well, the reason is that import statements are always hoisted in es6 module, so the <code>__webpack_public_path__</code> initialization in the first line of <code>app.ts</code> didn't have any effects in those hoisted import statements including the <code>css</code> file. So, after putting the <code>__webpack_public_path__</code> initialization into a separation file and get it imported into app.ts, problem resolved!</p>\n<div class=\"highlight highlight-source-js\"><pre><span class=\"pl-c\"><span class=\"pl-c\">//</span> app.ts</span>\n<span class=\"pl-k\">import</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>./public-path<span class=\"pl-pds\">\"</span></span>;\n<span class=\"pl-k\">import</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>./index.css<span class=\"pl-pds\">\"</span></span>;</pre></div>\n<div class=\"highlight highlight-source-js\"><pre><span class=\"pl-c\"><span class=\"pl-c\">//</span> public-path.ts</span>\n__webpack_public_path__ <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>...<span class=\"pl-pds\">\"</span></span></pre></div>","createdAt":"2019-01-29T12:54:03Z","labels":{"edges":[{"node":{"name":"post"}},{"node":{"name":"webpack"}}]}}}}},"pageContext":{"slug":8}}